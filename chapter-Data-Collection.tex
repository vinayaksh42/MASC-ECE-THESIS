%======================================================================
\chapter{Data Collection}\label{data}
%======================================================================
% This section describes the systematic approach we used to construct the dataset for our study on behavioural incompatibilities caused by newly added unchecked exceptions in upgraded Java libraries. 

This chapter describes the approach we use to construct the dataset for our study on behavioural incompatibilities caused by newly added unchecked exceptions in upgraded Java libraries. The data we collect creates the foundation for our analysis in subsequent chapters. Specifically, it enables UnCheckGuard to detect methods that introduce newly added unchecked exceptions, identify affected client call sites (Chapter~\ref{methodology}).

% Broadly, we require three sets of components: Java-based clients that depend on third-party libraries; the versions of the libraries declared as dependencies by these clients (``current'' versions); and the latest available versions of those same libraries (``latest'' versions). For each client-library pair, we also need to extract the set of unchecked exceptions thrown by the library methods actually used by the client.

To begin our analysis, we first collected suitable client projects. We used the DUETS dataset~\cite{durieux21:_duets}, which provides a curated list of Java-based clients hosted on GitHub, each with at least five stars. DUETS also pairs libraries with the clients, but we ignore the DUETS library declarations and instead consider all libraries declared as dependencies by each client.

The DUETS dataset contains a total of 147,991 Java projects with more than 5 stars on GitHub. DUETS further filters these projects to retain only single-module Maven projects, executes the test suite within each project, and ultimately leaves 34,280 projects. We then filter this dataset further by increasing the minimum number of GitHub stars for a Java project to 10 or more. Due to the newly added rate limiting by Maven Central\footnote{\tiny \url{https://www.sonatype.com/blog/maven-central-and-the-tragedy-of-the-commons}}, running all 19,290 Java projects collected after the filtering based on 10 or more GitHub stars has become difficult. We sample from DUETS by systematically selecting clients at an interval of 19 from the list. This approach yields a dataset of 1,011 clients, small enough to avoid the rate limiting, that represents real-world Java usage.

We attempted to download each client repository and discarded any client that failed to download.
Next, we checked whether the project included a \texttt{pom.xml} file, which indicates that it is a Maven-based project. This step was essential, as our analysis depends on running Maven commands. We compiled each client to produce a JAR file and kept only those clients that compiled successfully for further analysis.